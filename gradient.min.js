class Gradient {
    constructor() {
        this.canvas = document.querySelector("#gradient-canvas");
        this.ctx = this.canvas.getContext("2d");
        this.colors = [
            { r: 15, g: 26, b: 61, a: 0.2 },     // Dark blue
            { r: 95, g: 165, b: 249, a: 0.1 },   // Light blue (#5fa5f9)
            { r: 232, g: 121, b: 249, a: 0.1 },  // Pink (#e879f9)
            { r: 167, g: 139, b: 250, a: 0.1 }   // Purple (#a78bfa)
        ];
        this.baseColor = { r: 9, g: 9, b: 11 };  // Very dark background (zinc-950)
        this.time = 0;
        this.resize();
        window.addEventListener("resize", () => this.resize());
        this.animate();
    }

    resize() {
        this.w = this.canvas.width = window.innerWidth;
        this.h = this.canvas.height = window.innerHeight;
    }

    animate() {
        this.time += 0.001; // Even slower animation

        this.ctx.clearRect(0, 0, this.w, this.h);

        // Draw dark base background
        this.ctx.fillStyle = `rgb(${this.baseColor.r}, ${this.baseColor.g}, ${this.baseColor.b})`;
        this.ctx.fillRect(0, 0, this.w, this.h);

        // Create swirling colored gradients
        for (let i = 0; i < 3; i++) {
            const gradient = this.ctx.createRadialGradient(
                this.w * (0.5 + 0.2 * Math.cos(this.time + i * 2.1)),
                this.h * (0.5 + 0.2 * Math.sin(this.time + i * 2.1)),
                0,
                this.w * (0.5 + 0.2 * Math.cos(this.time + i * 2.1)),
                this.h * (0.5 + 0.2 * Math.sin(this.time + i * 2.1)),
                this.w * 0.5
            );

            this.colors.forEach((color, j) => {
                const pos = ((this.time * 0.1 + j * 0.25 + i * 0.1) % 1);
                gradient.addColorStop(
                    pos,
                    `rgba(${color.r}, ${color.g}, ${color.b}, ${color.a})`
                );
            });

            // Soft light blending for subtle color effects
            this.ctx.globalCompositeOperation = 'soft-light';
            this.ctx.fillStyle = gradient;
            this.ctx.fillRect(0, 0, this.w, this.h);
        }

        requestAnimationFrame(() => this.animate());
    }

    initGradient(selector) {
        this.canvas = document.querySelector(selector);
        this.ctx = this.canvas.getContext("2d");
        this.resize();
        this.animate();
    }
}

export { Gradient }; 